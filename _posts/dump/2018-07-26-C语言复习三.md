---
layout: post
category: dump
title: C语言复习三
description: 指针部分复习
---

## 指针简介
　　可以说指针是非常重要的了，在字符串、函数、数组方面都有着广泛的应用，指针使用好了真的可以大大简化我们的程序，但是如果使用不当，也会造成非常可怕的后果。<br>
　　从根本上来看，指针是一个值为内存地址的变量。正如char类型变量的值是字符，int类型变量的值是整数，指针的值是地址。首先来介绍如何将指针作为函数的参数进行使用，以及为什么要这么使用。<br>
　　要创建一个指针变量，首先需要声明指针变量的类型。
- 间接运算符*和地址运算符&：使用间接运算符 *找出存储在bal变量中的值。地址运算符&，通常后面跟一个变量的名称的时候，&给出该变量的地址。地址运算符 *，后跟一个指针名或是地址的时候， *给出存储在指针指向地址上的值。

```C
int bal=9;
int *ptr;
ptr=&bal;
printf("%d",*ptr);
printf("%d",bal);
```
　　这两个语句运行的结果是一样的，因为这里ptr指针指向的地址是bal变量的地址。
- 指针加一的问题：在系统中，地址按照字节编址。在C中，指针加一指的是增加一个存储单元。对于数组而言，意味着，加一后的地址指的是下一个元素的地址，而不是下一个字节的地址。所以我们在声明的时候需要指出来指针的类型，这样指针在加一指向下一个元素的时候就知道需要地址加多少了。
- 对于数组来说，数组名就能够表示数组的起始地址。

### 一个程序上的错误
　　今天自己在编写程序的时候，写出来了一个错误。编写程序的目的是通过函数实现对一个数组的赋值，但是却出现了数组访问越界的错误。原始的程序如下：

```C
void array(int *p)
{
      int cnt;
      scanf("%d",&cnt);
      for(int i=0;i<cnt;i++)
      {
            scanf("%d",(p+i));
      }
      for(int i=0;i<cnt;i++)
      {
            printf("%d",*(p+i));           
      }
}

//主函数如下：
void main()
{
      int a[]={};       //数组在声明之后没有进行初始化
      array(a);
}
```
　　在显示的过程中，虽然也全部都显示出来了，但是却报错stack smashed，查了一下这个错误，应该就是数组访问越界了。想了想，似乎之前确实没有这样的写法。我们通常在初始化的时候，使用列表的形式对数组直接进行了初始化，在这种情况下，我们可以不对数组元素进行说明，编译器根据列表内的元素的个数进行对应的匹配。如果我们在声明数组的时候，规定了数组元素个数，但是在初始化的时候，数组元素的个数却超过了声明的数组元素的个数，这个时候也是会出错的，但是我实际编写了这样的一个程序，运行，却没有出现这样的错误警告，不是非常明白为什么会出现这样的情况。<br>
　　回到上面的错误程序，对上面的程序进行修改，在初始化数组的时候，明确声明了数组的元素个数。
```C
void main()
{
      int a[5]={};
      array(a);
}
```
　　修改完成之后，程序正确运行。<br>
　　之前经常会使用的一种数组初始化的方式是开辟一个很大的数组空间，然后在接下来的过程中，需要使用多少元素的话就对多少元素进行操作即可。
- 因为数组名是该数组首元素的地址，作为实际参数的数组名要求形式参数是一个与之匹配的指针，只有在这样的情况下，C才会把int a[]和int *a解释成一样的。
- 在系统中，使用8个字节来存放对象的地址。

### 指针和多维数组
　　我们假设一个二维数组int zippo[4][2],zippo是地址的地址，在解引用的时候，需要两次操作才能获得原始的值。地址的地址或是指针的指针就是双重间接的例子。随着数组维度的增加，指针的复杂度也会随之增加。对于一个二维数组而言，可以说一次解引用之后得到的是第一行首元素的地址，列上的值还需要再通过第二次指针的操作才能实现。<br>
　　可以认为二维数组的名字代表的是行的首个元素的地址，*zippo表示的就是第一行的第一个元素的地址，*(zippo+1)表示的是第二行第一个元素的地址。

### 关于二维数组和指向指针的指针
　　首先粘上一个CSDN的链接，[二维数组和指向指针的指针](https://blog.csdn.net/cnctloveyu/article/details/4207199)<br>
　　我确实也进入了博客中所说的误区，认为对于二维数组，需要使用指向指针的指针，认为一个二维数组的名字就是指向指针的指针，自己也编程做了实验，发现确实运行之后得不到正确的结果。因为一个二维数组的定义是int a[3][2]，那么a的类型实际上是int *[3][2]数组类型，或者说是int *[][2]，意思是指向大小为2的数组指针，类型和int **p是不一样的，所以**p=a这种方式是会出错的。想起来最开始学习二维数组的时候，在声明一个二维数组的时候，行的参数可以省略不写，但是列的参数必须要写上。int a[][3]这样的声明是正确的。在上面写到的，int *[][2]，指向大小为2的数组指针，这个2的含义实际上就是二维数组列参量。
　　